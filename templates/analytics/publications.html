{% extends "base/base_dashboard.html" %}

{% block title %}Publications{% endblock %}

{% block dashboard_content %}
<div class="content-header">
    <h1>Publications Analysis</h1>
</div>

<div class="charts-container">
    <!-- Journal Grade Distribution -->
    <div class="chart-wrapper">
        <canvas id="gradeDistributionChart"></canvas>
    </div>

    <!-- Publications by Department -->
    <div class="chart-wrapper">
        <canvas id="deptPublicationChart"></canvas>
    </div>
</div>

<script>
const gradeDistData = {{ grade_distribution_data|safe }};
const deptPubData = {{ department_publication_data|safe }};

// Journal Grade Distribution Chart (Pie Chart)
if (gradeDistData && document.getElementById('gradeDistributionChart')) {
    new Chart(document.getElementById('gradeDistributionChart'), {
        type: 'pie',
        data: gradeDistData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Publications by Journal Grade'
                },
                legend: {
                    display: true,
                    position: 'right'
                }
            }
        }
    });
}

// Department Publications Chart (Bar Chart)
if (deptPubData && document.getElementById('deptPublicationChart')) {
    new Chart(document.getElementById('deptPublicationChart'), {
        type: 'bar',
        data: deptPubData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Publications by Department'
                },
                legend: {
                    display: false
                }
            },
            scales: {
                x: {
                    ticks: {
                        autoSkip: false,
                        maxRotation: 45,
                        minRotation: 45
                    }
                },
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
}
</script>
{% endblock %}
