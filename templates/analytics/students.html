{% extends "base/base_dashboard.html" %}

{% block title %}Students{% endblock %}

{% block dashboard_content %}
<div class="students-container">
    <h1>Student Statistics</h1>

    <!-- Total Students -->
    <div class="summary-stats">
        <div class="stat-card">
            <h3>Total Students</h3>
            <p>{{ total_students }}</p>
        </div>
    </div>

    <!-- Enrollment by Year -->
    <div class="chart-wrapper">
        <canvas id="enrollmentChart"></canvas>
    </div>

    <!-- Department Distribution -->
    <div class="chart-wrapper">
        <canvas id="deptDistChart"></canvas>
    </div>
</div>

<script>
const enrollmentData = {{ enrollment_by_year_data|safe }};
const deptDistData = {{ department_distribution_data|safe }};

// Enrollment by Year Chart (Line Chart)
if (enrollmentData && document.getElementById('enrollmentChart')) {
    new Chart(document.getElementById('enrollmentChart'), {
        type: 'line',
        data: enrollmentData,
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Student Enrollment by Year'
                },
                legend: {
                    display: true,
                    position: 'top'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
}

// Department Distribution Chart (Bar Chart)
if (deptDistData && document.getElementById('deptDistChart')) {
    new Chart(document.getElementById('deptDistChart'), {
        type: 'bar',
        data: deptDistData,
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Students by Department'
                },
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
}
</script>
{% endblock %}
